<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CS50-MCZ</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  <!-- <script type="text/javascript"
    src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> -->
  <link href="./assets/favicon-light.ico?" rel="icon" media="(prefers-color-scheme: light)" />
  <link href="./assets/favicon-dark.ico?" rel="icon" media="(prefers-color-scheme: dark)" />
</head>
<div class="res-topbar">
  <i class="fa fa-bars fa-lg ham-menu"></i>
</div>
<header>
  <nav class="sidenav">
    <div class="close-menu">
      <i class="fa fa-times fa-lg close-btn"></i>
    </div>
    <h2><a id="titulo" href="index.html">Isso é CS50</a></h2>
    <p>Introdução à Ciência da Computação</p>
    <br>
    <hr style="border: 0.1px solid rgb(54, 54, 54);">
    <br>
    <a href="week0.html">Week 0 - <em>Scratch</em></a>
    <a href="week1.html">Week 1 - <em>C</em></a>
    <a href="week2.html">Week 2 - <em>Arrays</em></a>
    <a href="week3.html">Week 3 - <em>Algoritmos</em></a>
    <a href="week4.html">Week 4 - <em>Memória</em></a>
    <a href="week5.html">Week 5 - <em>Estrutura de Dados</em></a>
    <a href="week6.html">Week 6 - <em>Python</em></a>
    <a href="week7.html">Week 7 - <em>SQL</em></a>
    <a href="week8.html">Week 8 - <em>HTML, CSS, JavaScript</em></a>
    <a href="week9.html">Week 9 - <em>Flask</em></a>
    <a href="week10.html">Week 10 - <em>Cibersegurança</em></a>
    <br>
    <hr style="border: 0.1px solid rgb(54, 54, 54);">
    <br>
    <a href="honesty.html">Honestidade Acadêmica</a>
    <a href="#">Preparando o Ambiente de Desenvolvimento</a>
  </nav>
  <div class="title">
    <h1>CS50-MCZ</h1>
    <p>Uma introdução aos empreendimentos intelectuais da Ciência da Computação e da arte da programação.</p>

</header>
<main class="main">
  <section>
    <br>
    <h2 class="no_toc" id="lecture-0">Week 9</h2>
    <hr>

    <p>Flask, Rotas, Decoradores, Requisições, Respostas, Sessões, Cookies.</p>


    <ul id="markdown-toc">
      <li data-marker="-"><strong>Shorts</strong>
        <ol>
          <li><a href="flask.html">Flask</a></li>
          <li><a href="ajax.html">Ajax</a></li>
          
        </ol>
      </li>
      <li><a href="lab9.html">Lab 9</a></li>
      <li><a href="pset9.html">Problem Set 9</a></li>
    </ul>
    <br>
    <section>
      <h2 id="welcome">Notas</h2>
      <hr>
    </section>

<h1 class="no_toc" id="lecture-6">Lecture 9</h1>


<ul id="markdown-toc">
    <li><a href="#welcome" id="markdown-toc-welcome">Bem-vindo!</a></li>
    <li><a href="#static-to-dynamic" id="markdown-toc-static-to-dynamic">Estático para Dinâmico</a></li>
    <li><a href="#flask" id="markdown-toc-flask">Flask</a></li>
    <li><a href="#layout" id="markdown-toc-layout">Layout</a></li>
    <li><a href="#post" id="markdown-toc-post">POST</a></li>
    <li><a href="#frosh-ims" id="markdown-toc-frosh-ims">Frosh IMs</a></li>
    <li><a href="#flask-and-sql" id="markdown-toc-flask-and-sql">Flask e SQL</a></li>
    <li><a href="#session" id="markdown-toc-session">Sessão</a></li>
    <li><a href="#store" id="markdown-toc-store">Armazenamento</a></li>
    <li><a href="#api" id="markdown-toc-api">API</a></li>
    <li><a href="#json" id="markdown-toc-json">JSON</a></li>
    <li><a href="#summing-up" id="markdown-toc-summing-up">Resumo</a></li>
  </ul>

  <h2 id="welcome">Bem-vindo!</h2>
<ul>
  <li data-marker="*">Nas semanas anteriores, você aprendeu várias linguagens de programação, técnicas e estratégias.</li>
  <li data-marker="*">De fato, esta aula foi muito menos uma <em>aula de C</em> ou uma <em>aula de Python</em> e muito mais uma <em>aula de programação</em>, para que você possa acompanhar as tendências futuras.</li>
  <li data-marker="*">Nas últimas semanas, você aprendeu <em>como aprender</em> sobre programação.</li>
  <li data-marker="*">Hoje, vamos passar do HTML e CSS para combinar HTML, CSS, SQL, Python e JavaScript, para que você possa criar suas próprias aplicações web.</li>
</ul>
<h2 id="static-to-dynamic">Estático para Dinâmico</h2>
<ul>
  <li data-marker="*">Até este ponto, todo o HTML que você viu era pré-escrito e estático.</li>
  <li data-marker="*">No passado, quando você visitava uma página, o navegador baixava uma página HTML e você conseguia visualizá-la.</li>
  <li data-marker="*">Páginas dinâmicas se referem à capacidade do Python e de linguagens similares de criar arquivos HTML sob demanda. Assim, você pode ter páginas da web que são geradas por opções selecionadas pelo usuário.</li>
  <li data-marker="*">Você já usou o <code class="language-plaintext highlighter-rouge">http-server</code> no passado para servir suas páginas da web. Hoje, vamos utilizar um novo servidor que pode analisar um endereço da web e executar ações com base na URL fornecida.</li>
</ul>

<h2 id="flask">Flask</h2>
<ul>
  <li data-marker="*"><em>Flask</em> é uma biblioteca de terceiros que permite hospedar aplicativos da web usando o framework Flask dentro do Python.</li>
  <li data-marker="*">Você pode executar o Flask executando <code class="language-plaintext highlighter-rouge">flask run</code>.</li>
  <li data-marker="*">Para fazer isso, você precisará de um arquivo chamado <code class="language-plaintext highlighter-rouge">app.py</code> e uma pasta chamada <code class="language-plaintext highlighter-rouge">templates</code>.</li>
  <li data-marker="*">Para começar, crie uma pasta chamada <code class="language-plaintext highlighter-rouge">templates</code> e crie um arquivo chamado <code class="language-plaintext highlighter-rouge">index.html</code> com o seguinte código:
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>hello<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        hello, {{ name }}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>

        <p>Observe o duplo marcador <code class="language-plaintext highlighter-rouge">{{ name }}</code> que é um espaço reservado para algo que será fornecido posteriormente pelo nosso servidor Flask.</p>
</li>
<li data-marker="*">
  <p>Em seguida, na mesma pasta em que a pasta <code class="language-plaintext highlighter-rouge">templates</code> aparece, crie um arquivo chamado <code class="language-plaintext highlighter-rouge">app.py</code> e adicione o seguinte código:</p>

  <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Greets user
</span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">world</span><span class="sh">"</span><span class="p">))</span>
</code></pre></div>    </div>

<p>Observe que este código define <code class="language-plaintext highlighter-rouge">app</code> como a aplicação Flask. Em seguida, ele define a rota <code class="language-plaintext highlighter-rouge">/</code> de <code class="language-plaintext highlighter-rouge">app</code> como retornando o conteúdo de <code class="language-plaintext highlighter-rouge">index.html</code> com o argumento <code class="language-plaintext highlighter-rouge">name</code>. Por padrão, a função <code class="language-plaintext highlighter-rouge">request.args.get</code> irá procurar pelo argumento <code class="language-plaintext highlighter-rouge">name</code> fornecido pelo usuário. Se nenhum nome for fornecido, ele irá usar <code class="language-plaintext highlighter-rouge">world</code> como padrão.</p>
  </li>
  <li data-marker="*">
    <p>Por fim, adicione um arquivo final na mesma pasta que <code class="language-plaintext highlighter-rouge">app.py</code> chamado <code class="language-plaintext highlighter-rouge">requirements.txt</code> que contém apenas uma única linha de código:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Flask</span>    </code></pre></div>    </div>

    <p>Observe que apenas <code class="language-plaintext highlighter-rouge">Flask</code> aparece neste arquivo.</p>
</li>
<li data-marker="*">
  <p>Você pode executar este arquivo digitando <code class="language-plaintext highlighter-rouge">flask run</code> na janela do terminal. Se o Flask não for executado, verifique se a sintaxe está correta em cada um dos arquivos acima. Além disso, se o Flask não for executado, certifique-se de que seus arquivos estejam organizados da seguinte maneira:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/templates
    index.html
    app.py
    requirements.txt
</code></pre></div>    </div>

<p>Uma vez que você o iniciar, será solicitado que você clique em um link. Ao navegar para aquela página da web, tente adicionar <code class="language-plaintext highlighter-rouge">?name=[Seu Nome]</code> à URL base na barra de URL do seu navegador.</p>
</li>
<li data-marker="*">
<p>Melhorando nosso programa, sabemos que a maioria dos usuários não digitará argumentos na barra de endereço. Em vez disso, os programadores contam com os usuários para preencherem formulários em páginas da web. Portanto, podemos modificar o index.html da seguinte forma:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>hello<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/greet"</span> <span class="na">method=</span><span class="s">"get"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"Name"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Greet<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
    </code></pre></div>    </div>

    <p>Observe que um formulário é criado agora, que recebe o nome do usuário e o envia para uma rota chamada <code class="language-plaintext highlighter-rouge">/greet</code>.</p>
  </li>
  <li data-marker="*">
    <p>Além disso, podemos alterar o <code class="language-plaintext highlighter-rouge">app.py</code> da seguinte maneira:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Adds a form, second route
    </span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/greet</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">greet.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">world</span><span class="sh">"</span><span class="p">))</span>
    </code></pre></div>    </div>

    <p>Observe que o caminho padrão exibirá um formulário para o usuário inserir seu nome. A rota <code class="language-plaintext highlighter-rouge">/greet</code> passará o <code class="language-plaintext highlighter-rouge">name</code> para essa página da web.</p>
  </li>
  <li data-marker="*">
    <p>Para finalizar esta implementação, você precisará de outro modelo para <code class="language-plaintext highlighter-rouge">greet.html</code> conforme mostrado abaixo:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>hello<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        hello, {{ name }}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>

        <p>Observe que esta rota agora renderizará a saudação ao usuário, seguida pelo nome deles.</p>
</li>
</ul>
<h2 id="layout">Layout</h2>
<ul>
  <li data-marker="*">Ambas as nossas páginas da web, <code class="language-plaintext highlighter-rouge">index.html</code> e <code class="language-plaintext highlighter-rouge">greet.html</code>, possuem grande parte dos mesmos dados. Não seria bom permitir que o corpo seja único, mas copiar o mesmo layout de página para página?</li>
  <li data-marker="*">
    <p>Primeiro, crie um novo modelo chamado <code class="language-plaintext highlighter-rouge">layout.html</code> e escreva o código da seguinte forma:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>hello<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {% block body %}{% endblock %}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>

        <p>Observe que a tag <code class="language-plaintext highlighter-rouge">{% block body %}{% endblock %}</code> permite a inserção de código de outros arquivos HTML.</p>
  </li>
  <li data-marker="*">
    <p>Em seguida, modifique o seu arquivo <code class="language-plaintext highlighter-rouge">index.html</code> da seguinte maneira:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}

    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/greet"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"Name"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Greet<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/form&gt;</span>

{% endblock %}
        </code></pre></div>    </div>

        <p>Observe que a linha <code class="language-plaintext highlighter-rouge">{% extends "layout.html" %}</code> informa ao servidor de onde obter o layout desta página. Em seguida, o <code class="language-plaintext highlighter-rouge">{% block body %}{% endblock %}</code> indica qual código deve ser inserido em <code class="language-plaintext highlighter-rouge">layout.html</code>.</p>
  </li>
  <li data-marker="*">
    <p>Por fim, altere <code class="language-plaintext highlighter-rouge">greet.html</code> da seguinte forma:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    hello, {{ name }}
{% endblock %}
        </code></pre></div>    </div>

        <p>Observe como esse código é mais curto e compacto.</p>
  </li>
</ul>
<h2 id="post">POST</h2>
<ul>
  <li data-marker="*">Você pode imaginar cenários em que não é seguro utilizar <code class="language-plaintext highlighter-rouge">get</code>, pois nomes de usuário e senhas apareceriam na URL.</li>
  <li data-marker="*">
    <p>Podemos utilizar o método <code class="language-plaintext highlighter-rouge">post</code> para ajudar com esse problema, modificando o arquivo <code class="language-plaintext highlighter-rouge">app.py</code> da seguinte forma:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Switches to POST
    </span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/greet</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">greet.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">world</span><span class="sh">"</span><span class="p">))</span>
    </code></pre></div>    </div>

    <p>Observe que <code class="language-plaintext highlighter-rouge">POST</code> é adicionado à rota <code class="language-plaintext highlighter-rouge">/greet</code> e que usamos <code class="language-plaintext highlighter-rouge">request.form.get</code> em vez de <code class="language-plaintext highlighter-rouge">request.args.get</code>.</p>
  </li>
  <li data-marker="*">Isso diz ao servidor para procurar <em>mais profundamente</em> no envelope virtual e não revelar os itens em <code class="language-plaintext highlighter-rouge">post</code> na URL.</li>
  <li data-marker="*">
    <p>Ainda assim, este código pode ser avançado ainda mais utilizando uma única rota para ambos <code class="language-plaintext highlighter-rouge">get</code> e <code class="language-plaintext highlighter-rouge">post</code>. Para fazer isso, modifique <code class="language-plaintext highlighter-rouge">app.py</code> da seguinte forma:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Uses a single route
    </span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">GET</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">greet.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">world</span><span class="sh">"</span><span class="p">))</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">)</span>
    </code></pre></div>    </div>

    <p>Observe que tanto o método <code class="language-plaintext highlighter-rouge">get</code> quanto o método <code class="language-plaintext highlighter-rouge">post</code> são feitos em uma única rota. No entanto, o <code class="language-plaintext highlighter-rouge">request.method</code> é utilizado para rotear corretamente com base no tipo de roteamento solicitado pelo usuário.</p>
  </li>
</ul>
<h2 id="frosh-ims">Frosh IMs</h2>
<ul>
  <li data-marker="*">Frosh IMs ou <em>froshims</em> é um aplicativo da web que permite que os estudantes se inscrevam em esportes intermurais.</li>
  <li data-marker="*">
    <p>Crie uma pasta digitando <code class="language-plaintext highlighter-rouge">mkdir froshims</code> no terminal. Em seguida, digite <code class="language-plaintext highlighter-rouge">cd froshims</code> para navegar até essa pasta. Dentro dela, crie um diretório chamado templates digitando <code class="language-plaintext highlighter-rouge">mkdir templates</code>. Por fim, digite <code class="language-plaintext highlighter-rouge">code app.py</code> e escreva o código da seguinte forma:</p>

    <p>Observe que é fornecida uma opção de <code class="language-plaintext highlighter-rouge">failure</code>, de modo que uma mensagem de falha será exibida ao usuário se o campo <code class="language-plaintext highlighter-rouge">name</code> ou <code class="language-plaintext highlighter-rouge">sport</code> não for preenchido corretamente.</p>
  </li>
  <li data-marker="*">
    <p>Em seguida, crie um arquivo na pasta <code class="language-plaintext highlighter-rouge">templates</code> chamado <code class="language-plaintext highlighter-rouge">index.html</code> digitando <code class="language-plaintext highlighter-rouge">code templates/index.html</code> e escreva o código da seguinte forma:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Register<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/register"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"Name"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"sport"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">disabled</span> <span class="na">selected</span><span class="nt">&gt;</span>Sport<span class="nt">&lt;/option&gt;</span>
            {% for sport in sports %}
                <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"{{ sport }}"</span><span class="nt">&gt;</span>{{ sport }}<span class="nt">&lt;/option&gt;</span>
            {% endfor %}
        <span class="nt">&lt;/select&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Register<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
{% endblock %}
        </code></pre></div>    </div>

    </li>
    <li data-marker="*">
      <p>Em seguida, crie um arquivo chamado <code class="language-plaintext highlighter-rouge">layout.html</code> digitando <code class="language-plaintext highlighter-rouge">code templates/layout.html</code> e escreva o código da seguinte forma:</p>

      <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>froshims<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {% block body %}{% endblock %}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>
          </li>

          <li data-marker="*">
            <p>Quarto, crie um arquivo no diretório "templates" chamado <code class="language-plaintext highlighter-rouge">success.html</code> da seguinte forma:</p>

            <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    You are registered!
{% endblock %}
                </code></pre></div>    </div>
                  </li>

                  <li data-marker="*">
                    <p>Por fim, crie um arquivo chamado <code class="language-plaintext highlighter-rouge">failure.html</code> na pasta de templates, da seguinte forma:</p>

                    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    You are not registered!
{% endblock %}
                        </code></pre></div>    </div>
                          </li>

                          <li data-marker="*">
                            <p>Você pode imaginar como podemos querer aceitar o registro de muitos registrantes diferentes. Podemos melhorar <code class="language-plaintext highlighter-rouge">app.py</code> da seguinte forma:</p>

                            <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Implements a registration form, storing registrants in a dictionary, with error messages
                            </span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">REGISTRANTS</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">SPORTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Basketball</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Soccer</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Ultimate Frisbee</span><span class="sh">"</span>
<span class="p">]</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">sports</span><span class="o">=</span><span class="n">SPORTS</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/register</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>

    <span class="c1"># Validate name
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">error.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sh">"</span><span class="s">Missing name</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Validate sport
</span>    <span class="n">sport</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">sport</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sport</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">error.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sh">"</span><span class="s">Missing sport</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sport</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPORTS</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">error.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sh">"</span><span class="s">Invalid sport</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Remember registrant
</span>    <span class="n">REGISTRANTS</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sport</span>

    <span class="c1"># Confirm registration
</span>    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/registrants</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/registrants</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">registrants</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">registrants.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">registrants</span><span class="o">=</span><span class="n">REGISTRANTS</span><span class="p">)</span>
                            </code></pre></div>    </div>

                            <p>Observe que um dicionário chamado <code class="language-plaintext highlighter-rouge">REGISTRANTS</code> é usado para registrar o esporte selecionado por <code class="language-plaintext highlighter-rouge">REGISTRANTS[name]</code>. Além disso, observe que <code class="language-plaintext highlighter-rouge">registrants=REGISTRANTS</code> passa o dicionário para este modelo.</p>
  </li>
  <li data-marker="*">
    <p>Além disso, crie um novo modelo chamado <code class="language-plaintext highlighter-rouge">registrants.html</code> da seguinte maneira:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Registrants<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;table&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th&gt;</span>Sport<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
            {% for name in registrants %}
                <span class="nt">&lt;tr&gt;</span>
                    <span class="nt">&lt;td&gt;</span>{{ name }}<span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;</span>{{ registrants[name] }}<span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;/tr&gt;</span>
            {% endfor %}
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
{% endblock %}
        </code></pre></div>    </div>

        <p>Observe que <code class="language-plaintext highlighter-rouge">{% for name in registrants %}...{% endfor %}</code> irá iterar por cada um dos registrants. Muito poderoso poder iterar em uma página web dinâmica!</p>
  </li>
  <li data-marker="*">Executando <code class="language-plaintext highlighter-rouge">flask run</code> e inserindo vários nomes e esportes, você pode navegar até <code class="language-plaintext highlighter-rouge">/registrants</code> para ver quais dados foram registrados.</li>
  <li data-marker="*">Agora você tem uma aplicação web! No entanto, existem algumas falhas de segurança! Como tudo é feito do lado do cliente, um adversário poderia alterar o HTML e <em>hackear</em> um site. Além disso, esses dados não persistirão se o servidor for desligado. Será que há alguma maneira de fazer com que nossos dados persistam mesmo quando o servidor for reiniciado?</li>
</ul>
<h2 id="flask-and-sql">Flask e SQL</h2>
<ul>
  <li data-marker="*">Assim como vimos como o Python pode interagir com um banco de dados SQL, podemos combinar o poder do Flask, Python e SQL para criar uma aplicação web onde os dados persistirão!</li>
  <li data-marker="*">Para implementar isso, você precisará seguir algumas etapas.</li>
  <li data-marker="*">
    <p>Primeiro, modifique o arquivo <code class="language-plaintext highlighter-rouge">requirements.txt</code> da seguinte maneira:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cs50
Flask        </code></pre></div>    </div>

</li>
<li data-marker="*">
  <p>Modifique o <code class="language-plaintext highlighter-rouge">index.html</code> da seguinte maneira:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Register<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/register"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"Name"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        {% for sport in sports %}
            <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"sport"</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"{{ sport }}"</span><span class="nt">&gt;</span> {{ sport }}
        {% endfor %}
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Register<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
{% endblock %}
    </code></pre></div>    </div>

</li>
<li data-marker="*">
  <p>Modifique <code class="language-plaintext highlighter-rouge">layout.html</code> da seguinte forma:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>froshims<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {% block body %}{% endblock %}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
    </code></pre></div>    </div>

</li>
<li data-marker="*">
  <p>Garanta que o <code class="language-plaintext highlighter-rouge">failure.html</code> apareça da seguinte forma:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    You are not registered!
{% endblock %}
    </code></pre></div>    </div>

</li>
<li data-marker="*">
  <p>Modifique <code class="language-plaintext highlighter-rouge">registrants.html</code> para aparecer da seguinte forma:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Registrants<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;table&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th&gt;</span>Sport<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
            {% for registrant in registrants %}
                <span class="nt">&lt;tr&gt;</span>
                    <span class="nt">&lt;td&gt;</span>{{ registrant.name }}<span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;</span>{{ registrant.sport }}<span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;</span>
                        <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/deregister"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"id"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"{{ registrant.id }}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Deregister<span class="nt">&lt;/button&gt;</span>
                        <span class="nt">&lt;/form&gt;</span>
                    <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;/tr&gt;</span>
            {% endfor %}
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
{% endblock %}
    </code></pre></div>    </div>

    <p>Observe que um valor oculto <code class="language-plaintext highlighter-rouge">registrant.id</code> é incluído para que seja possível usar esse <code class="language-plaintext highlighter-rouge">id</code> posteriormente no arquivo <code class="language-plaintext highlighter-rouge">app.py</code></p>
  </li>
  <li data-marker="*">
    <p>Por fim, modifique o arquivo <code class="language-plaintext highlighter-rouge">app.py</code> da seguinte forma:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Implements a registration form, storing registrants in a SQLite database, with support for deregistration
    </span>
<span class="kn">from</span> <span class="n">cs50</span> <span class="kn">import</span> <span class="n">SQL</span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">db</span> <span class="o">=</span> <span class="nc">SQL</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlite:///froshims.db</span><span class="sh">"</span><span class="p">)</span>

<span class="n">SPORTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Basketball</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Soccer</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Ultimate Frisbee</span><span class="sh">"</span>
<span class="p">]</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">sports</span><span class="o">=</span><span class="n">SPORTS</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/deregister</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">deregister</span><span class="p">():</span>

    <span class="c1"># Forget registrant
</span>    <span class="nb">id</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">id</span><span class="p">:</span>
        <span class="n">db</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">DELETE FROM registrants WHERE id = ?</span><span class="sh">"</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/registrants</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/register</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>

    <span class="c1"># Validate submission
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">sport</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">sport</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">sport</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPORTS</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">failure.html</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Remember registrant
</span>    <span class="n">db</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">INSERT INTO registrants (name, sport) VALUES(?, ?)</span><span class="sh">"</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sport</span><span class="p">)</span>

    <span class="c1"># Confirm registration
</span>    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/registrants</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/registrants</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">registrants</span><span class="p">():</span>
    <span class="n">registrants</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM registrants</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">registrants.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">registrants</span><span class="o">=</span><span class="n">registrants</span><span class="p">)</span>
    </code></pre></div>    </div>

    <p>Observe que a biblioteca <code class="language-plaintext highlighter-rouge">cs50</code> é utilizada. Uma rota é incluída para o método <code class="language-plaintext highlighter-rouge">register</code> para o método <code class="language-plaintext highlighter-rouge">post</code>. Essa rota irá receber o nome e o esporte obtidos do formulário de registro e executar uma consulta SQL para adicionar o <code class="language-plaintext highlighter-rouge">nome</code> e o <code class="language-plaintext highlighter-rouge">esporte</code> à tabela <code class="language-plaintext highlighter-rouge">registrants</code>. A rota <code class="language-plaintext highlighter-rouge">deregister</code> direciona para uma consulta SQL que irá obter o <code class="language-plaintext highlighter-rouge">id</code> do usuário e utilizar essa informação para cancelar o registro deste indivíduo.</p>
</li>
<li data-marker="*">Você pode ler mais na <a href="https://flask.palletsprojects.com" target="_blank">documentação do Flask</a>.</li>
</ul>
<h2 id="session">Session</h2>
<ul>
<li data-marker="*">Embora o código acima seja útil do ponto de vista administrativo, onde um administrador de back-office poderia adicionar e remover indivíduos do banco de dados, pode-se imaginar como esse código não é seguro para implementar em um servidor público.</li>
<li data-marker="*">Por um lado, atores mal-intencionados poderiam tomar decisões em nome de outros usuários ao clicar no botão "deregister" - efetivamente excluindo a resposta registrada do servidor.</li>
<li data-marker="*">Serviços da web como o Google utilizam credenciais de login para garantir que os usuários tenham acesso apenas aos dados corretos.</li>
<li data-marker="*">Na verdade, podemos implementar isso usando <em>cookies</em>. Cookies são pequenos arquivos que são armazenados no seu computador, de forma que o seu computador possa se comunicar com o servidor e efetivamente dizer: "Eu sou um usuário autorizado que já fez login".</li>
<li data-marker="*">Na forma mais simples, podemos implementar isso criando uma pasta chamada <code class="language-plaintext highlighter-rouge">login</code> e, em seguida, adicionando os seguintes arquivos.</li>
<li data-marker="*">
<p>Primeiro, crie um arquivo chamado <code class="language-plaintext highlighter-rouge">requirements.txt</code> que contenha o seguinte:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Flask
Flask-Session    </code></pre></div>    </div>

<p>Note que além do <code class="language-plaintext highlighter-rouge">Flask</code>, também incluímos o <code class="language-plaintext highlighter-rouge">Flask-Session</code>, que é necessário para suportar sessões de login.</p>
  </li>
  <li data-marker="*">
    <p>Segundo, em uma pasta <code class="language-plaintext highlighter-rouge">templates</code>, crie um arquivo chamado <code class="language-plaintext highlighter-rouge">layout.html</code> que aparece da seguinte forma:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>store<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {% block body %}{% endblock %}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>

        <p>Observe que isso fornece um layout muito simples com um título e um corpo.</p>
  </li>
  <li data-marker="*">
    <p>Terceiro, crie um arquivo na pasta <code class="language-plaintext highlighter-rouge">templates</code> chamado <code class="language-plaintext highlighter-rouge">index.html</code> que aparece da seguinte forma:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}

    {% if session["name"] %}
        You are logged in as {{ session["name"] }}. <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/logout"</span><span class="nt">&gt;</span>Log out<span class="nt">&lt;/a&gt;</span>.
    {% else %}
        You are not logged in. <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/login"</span><span class="nt">&gt;</span>Log in<span class="nt">&lt;/a&gt;</span>.
    {% endif %}

{% endblock %}
        </code></pre></div>    </div>

        <p>Observe que este arquivo verifica se <code class="language-plaintext highlighter-rouge">session["name"]</code> existe. Se existir, será exibida uma mensagem de boas-vindas. Caso contrário, será recomendado que você acesse uma página para fazer login.</p>
  </li>
  <li data-marker="*">
    <p>Quarto, crie um arquivo chamado <code class="language-plaintext highlighter-rouge">login.html</code> e adicione o seguinte código:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends "layout.html" %}

{% block body %}

    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/login"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"Name"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Log In<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/form&gt;</span>

{% endblock %}
        </code></pre></div>    </div>

        <p>Observe que este é o layout de uma página básica de login.</p>
  </li>
  <li data-marker="*">
    <p>Finalmente, crie um arquivo na pasta <code class="language-plaintext highlighter-rouge">login</code> chamado <code class="language-plaintext highlighter-rouge">app.py</code> e escreva o código da seguinte forma:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span>
<span class="kn">from</span> <span class="n">flask_session</span> <span class="kn">import</span> <span class="n">Session</span>

<span class="c1"># Configure app
</span><span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="c1"># Configure session
</span><span class="n">app</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">SESSION_PERMANENT</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">app</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">SESSION_TYPE</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">filesystem</span><span class="sh">"</span>
<span class="nc">Session</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/login</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/login</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">GET</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">login.html</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/logout</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
    <span class="n">session</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
        </code></pre></div>    </div>

        <p>Observe as <em>importações</em> modificadas no início do arquivo, incluindo <code class="language-plaintext highlighter-rouge">session</code>, que permitirá o suporte a sessões. Mais importante, observe como <code class="language-plaintext highlighter-rouge">session["name"]</code> é utilizado nas rotas <code class="language-plaintext highlighter-rouge">login</code> e <code class="language-plaintext highlighter-rouge">logout</code>. A rota <code class="language-plaintext highlighter-rouge">login</code> atribuirá o nome de login fornecido a <code class="language-plaintext highlighter-rouge">session["name"]</code>. No entanto, na rota <code class="language-plaintext highlighter-rouge">logout</code>, o logout é implementado simplesmente definindo <code class="language-plaintext highlighter-rouge">session["name"]</code> como <code class="language-plaintext highlighter-rouge">None</code>.</p>
</li>
<li data-marker="*">Você pode ler mais sobre sessões na <a href="https://flask.palletsprojects.com/en/2.2.x/api/?highlight=session#flask.session" target="_blank">documentação do Flask</a>.</li>
</ul>
<h2 id="store">Store</h2>
<ul>
<li data-marker="*">Passando para um exemplo final de utilização da capacidade do Flask de habilitar uma sessão.</li>
<li data-marker="*">
<p>Analisamos o seguinte código para <code class="language-plaintext highlighter-rouge">store</code> em <code class="language-plaintext highlighter-rouge">app.py</code>. O código a seguir foi mostrado:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">cs50</span> <span class="kn">import</span> <span class="n">SQL</span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span>
<span class="kn">from</span> <span class="n">flask_session</span> <span class="kn">import</span> <span class="n">Session</span>

<span class="c1"># Configure app
</span><span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="c1"># Connect to database
</span><span class="n">db</span> <span class="o">=</span> <span class="nc">SQL</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlite:///store.db</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Configure session
</span><span class="n">app</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">SESSION_PERMANENT</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">app</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">SESSION_TYPE</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">filesystem</span><span class="sh">"</span>
<span class="nc">Session</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">books</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM books</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">books.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">books</span><span class="o">=</span><span class="n">books</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/cart</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">GET</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">cart</span><span class="p">():</span>

    <span class="c1"># Ensure cart exists
</span>    <span class="k">if</span> <span class="sh">"</span><span class="s">cart</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="sh">"</span><span class="s">cart</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># POST
</span>    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span><span class="p">:</span>
            <span class="n">session</span><span class="p">[</span><span class="sh">"</span><span class="s">cart</span><span class="sh">"</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/cart</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># GET
</span>    <span class="n">books</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM books WHERE id IN (?)</span><span class="sh">"</span><span class="p">,</span> <span class="n">session</span><span class="p">[</span><span class="sh">"</span><span class="s">cart</span><span class="sh">"</span><span class="p">])</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">cart.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">books</span><span class="o">=</span><span class="n">books</span><span class="p">)</span>
    </code></pre></div>    </div>

    <p>Observe que o <code class="language-plaintext highlighter-rouge">cart</code> é implementado usando uma lista. Itens podem ser adicionados a essa lista usando os botões <code class="language-plaintext highlighter-rouge">Add to Cart</code> em <code class="language-plaintext highlighter-rouge">books.html</code>. Ao clicar nesse botão, o método <code class="language-plaintext highlighter-rouge">post</code> é invocado, onde o <code class="language-plaintext highlighter-rouge">id</code> do item é acrescentado ao <code class="language-plaintext highlighter-rouge">cart</code>. Ao visualizar o carrinho, ao invocar o método <code class="language-plaintext highlighter-rouge">get</code>, é executado SQL para exibir uma lista dos livros no carrinho.</p>
  </li>
</ul>
<h2 id="api">API</h2>
<ul>
  <li data-marker="*">Uma <em>Interface de Programação de Aplicativos</em> ou <em>API</em> é uma série de especificações que permitem a interface com outro serviço. Por exemplo, poderíamos utilizar a API do IMDB para acessar seu banco de dados. Também poderíamos integrar APIs para lidar com tipos específicos de dados baixáveis de um servidor.</li>
  <li data-marker="*">Vimos um exemplo chamado <code class="language-plaintext highlighter-rouge">shows</code>.</li>
  <li data-marker="*">
    <p>Ao analisar o arquivo <code class="language-plaintext highlighter-rouge">app.py</code>, vimos o seguinte:</p>

    <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Searches for shows using Ajax
    </span>
<span class="kn">from</span> <span class="n">cs50</span> <span class="kn">import</span> <span class="n">SQL</span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">db</span> <span class="o">=</span> <span class="nc">SQL</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlite:///shows.db</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">index.html</span><span class="sh">"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/search</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">search</span><span class="p">():</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">q</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">shows</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM shows WHERE title LIKE ? LIMIT 50</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">%</span><span class="sh">"</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="sh">"</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">"</span><span class="s">search.html</span><span class="sh">"</span><span class="p">,</span> <span class="n">shows</span><span class="o">=</span><span class="n">shows</span><span class="p">)</span>
    </code></pre></div>    </div>

    <p>Observe que a rota <code class="language-plaintext highlighter-rouge">search</code> executa uma consulta SQL.</p>
  </li>
  <li data-marker="*">
    <p>Ao olhar para <code class="language-plaintext highlighter-rouge">search.html</code>, você notará que é muito simples:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% for show in shows %}
    <span class="nt">&lt;li&gt;</span>{{ show["title"] }}<span class="nt">&lt;/li&gt;</span>
{% endfor %}
    </code></pre></div>    </div>

    <p>Observe que ele fornece uma lista com marcadores.</p>
  </li>
  <li data-marker="*">
    <p>Por fim, ao olhar para <code class="language-plaintext highlighter-rouge">index.html</code>, observe que o código <em>AJAX</em> é utilizado para alimentar a pesquisa:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>shows<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>

        <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">placeholder=</span><span class="s">"Query"</span> <span class="na">type=</span><span class="s">"search"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;ul&gt;&lt;/ul&gt;</span>

        <span class="nt">&lt;script&gt;</span>

            <span class="kd">let</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">input</span><span class="p">.</span><span class="nf">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">/search?q=</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
                <span class="kd">let</span> <span class="nx">shows</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nf">text</span><span class="p">();</span>
                <span class="nb">document</span><span class="p">.</span><span class="nf">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">ul</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">shows</span><span class="p">;</span>
            <span class="p">});</span>

        <span class="nt">&lt;/script&gt;</span>

    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>

        <p>Observe que um ouvinte de eventos é utilizado para consultar dinamicamente o servidor e fornecer uma lista que corresponda ao título fornecido. Isso irá localizar a tag <code class="language-plaintext highlighter-rouge">ul</code> no HTML e modificar a página da web de acordo para incluir a lista das correspondências.</p>
  </li>
  <li data-marker="*">Você pode ler mais na <a href="https://api.jquery.com/category/ajax/" target="_blank">documentação AJAX</a>.</li>
</ul>
<h2 id="json">JSON</h2>
<ul>
  <li data-marker="*"><em>JavaScript Object Notation</em> ou <em>JSON</em> é um arquivo de texto com dicionários contendo chaves e valores. Essa é uma maneira bruta e amigável para computadores obterem muitos dados.</li>
  <li data-marker="*">JSON é uma maneira muito útil de obter dados do servidor.</li>
  <li data-marker="*">
    <p>Você pode ver isso em ação no arquivo <code class="language-plaintext highlighter-rouge">index.html</code> que examinamos juntos:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, width=device-width"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>shows<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>

        <span class="nt">&lt;input</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">autofocus</span> <span class="na">placeholder=</span><span class="s">"Query"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;ul&gt;&lt;/ul&gt;</span>

        <span class="nt">&lt;script&gt;</span>

            <span class="kd">let</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">input</span><span class="p">.</span><span class="nf">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">/search?q=</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
                <span class="kd">let</span> <span class="nx">shows</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nf">json</span><span class="p">();</span>
                <span class="kd">let</span> <span class="nx">html</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
                <span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">id</span> <span class="k">in</span> <span class="nx">shows</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">let</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">shows</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">title</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;lt;</span><span class="dl">'</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">&amp;</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;amp;</span><span class="dl">'</span><span class="p">);</span>
                    <span class="nx">html</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">&lt;li&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">title</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/li&gt;</span><span class="dl">'</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nb">document</span><span class="p">.</span><span class="nf">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">ul</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">html</span><span class="p">;</span>
            <span class="p">});</span>

        <span class="nt">&lt;/script&gt;</span>

    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        </code></pre></div>    </div>

        <p>Embora o acima possa ser um tanto criptico, ele fornece um ponto de partida para você pesquisar sobre JSON por conta própria e ver como ele pode ser implementado em suas próprias aplicações web.</p>
  </li>
  <li data-marker="*">Você pode ler mais na <a href="https://www.json.org/json-en.html" target="_blank">documentação do JSON</a>.</li>
</ul>
<h2 id="summing-up">Resumindo</h2>
<p>Nesta lição, você aprendeu como utilizar Python, SQL e Flask para criar aplicações web. Especificamente, discutimos...</p>
<ul>
  <li data-marker="*">GET</li>
  <li data-marker="*">POST</li>
  <li data-marker="*">Flask</li>
  <li data-marker="*">Session</li>
  <li data-marker="*">AJAX</li>
  <li data-marker="*">JSON</li>
</ul>





    <p>Até a próxima, na nossa aula final!</p>



</main>
<footer>
  <p>Isso é CS50</p>
</footer>



<script src="script.js"></script>
<script src="menu.js"></script>





</html>